"use strict";(self.webpackChunkstock_nse=self.webpackChunkstock_nse||[]).push([[669],{4669:(K,h,u)=>{u.r(h),u.d(h,{OptionModule:()=>B});var g=u(6895),m=u(580),v=u(7579),C=u(9646),b=u(2076),A=u(5577),O=u(4128),y=u(262),Z=u(4004),U=u(8505),t=u(8256),R=u(2342),p=u(4006);function q(l,o){if(1&l&&(t.TgZ(0,"option",13),t._uU(1),t.qZA()),2&l){const n=o.$implicit;t.Q6J("value",o.index),t.xp6(1),t.hij(" ",n.timestamp," ")}}function I(l,o){if(1&l){const n=t.EpF();t.TgZ(0,"div",1)(1,"select",3),t.NdJ("ngModelChange",function(a){t.CHM(n);const i=t.oxw();return t.KtG(i.data.n=a)})("change",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.time_change(a.data))}),t.TgZ(2,"option"),t._uU(3,"-SELECT-"),t.qZA(),t.YNc(4,q,2,2,"option",12),t.qZA()()}if(2&l){const n=t.oxw();t.xp6(1),t.Q6J("ngModel",n.data.n),t.xp6(3),t.Q6J("ngForOf",n.data.all.PCR)}}const c=function(l,o,n){return{"bg-primary-subtle":l,"text-danger":o,"text-success":n}};function J(l,o){if(1&l&&(t.TgZ(0,"tr")(1,"td",30),t._uU(2),t.ALo(3,"number"),t.TgZ(4,"span",31),t._uU(5),t.qZA()(),t.TgZ(6,"td",30),t._uU(7),t.ALo(8,"number"),t.TgZ(9,"span",31),t._uU(10),t.qZA()(),t.TgZ(11,"td",28),t._uU(12),t.qZA(),t.TgZ(13,"td",29),t._uU(14),t.ALo(15,"number"),t.qZA(),t.TgZ(16,"td",28),t._uU(17),t.qZA(),t.TgZ(18,"td",30),t._uU(19),t.ALo(20,"number"),t.qZA(),t.TgZ(21,"td",30),t._uU(22),t.ALo(23,"number"),t.qZA()()),2&l){const n=o.$implicit,e=t.oxw(5);t.xp6(1),t.Tol(t.kEZ(35,c,0==n.flag,((null==n||null==n.CE?null:n.CE.change)||0)<0,((null==n||null==n.CE?null:n.CE.change)||0)>0)),t.Q6J("title",(null==n||null==n.CE?null:n.CE.change)||""),t.xp6(1),t.hij(" ",t.lcZ(3,25,(null==n||null==n.CE?null:n.CE.openInterest)||0)," "),t.xp6(3),t.hij(" (",e.n(((null==n||null==n.PE?null:n.PE.openInterest)||0)/((null==n||null==n.CE?null:n.CE.openInterest)||0)),") "),t.xp6(1),t.Tol(t.kEZ(39,c,0==n.flag,((null==n||null==n.CE?null:n.CE.change)||0)<0,((null==n||null==n.CE?null:n.CE.change)||0)>0)),t.Q6J("title",(null==n||null==n.CE?null:n.CE.change)||""),t.xp6(1),t.hij(" ",t.lcZ(8,27,null==n||null==n.CE?null:n.CE.changeinOpenInterest)," "),t.xp6(3),t.hij(" (",e.n(((null==n||null==n.PE?null:n.PE.changeinOpenInterest)||0)/((null==n||null==n.CE?null:n.CE.changeinOpenInterest)||0)),") "),t.xp6(1),t.Tol(t.kEZ(43,c,0==n.flag,((null==n||null==n.CE?null:n.CE.change)||0)<0,((null==n||null==n.CE?null:n.CE.change)||0)>0)),t.xp6(1),t.hij(" ",e.n((null==n||null==n.CE?null:n.CE.lastPrice)||0)," "),t.xp6(2),t.hij(" ",t.lcZ(15,29,(null==n?null:n.strikePrice)||0)," "),t.xp6(2),t.Tol(t.kEZ(47,c,1==n.flag,((null==n||null==n.PE?null:n.PE.change)||0)<0,((null==n||null==n.PE?null:n.PE.change)||0)>0)),t.xp6(1),t.hij(" ",e.n((null==n||null==n.PE?null:n.PE.lastPrice)||0)," "),t.xp6(1),t.Tol(t.kEZ(51,c,1==n.flag,((null==n||null==n.PE?null:n.PE.change)||0)<0,((null==n||null==n.PE?null:n.PE.change)||0)>0)),t.Q6J("title",(null==n||null==n.PE?null:n.PE.change)||""),t.xp6(1),t.hij(" ",t.lcZ(20,31,null==n||null==n.PE?null:n.PE.changeinOpenInterest)," "),t.xp6(2),t.Tol(t.kEZ(55,c,1==n.flag,((null==n||null==n.PE?null:n.PE.change)||0)<0,((null==n||null==n.PE?null:n.PE.change)||0)>0)),t.Q6J("title",(null==n||null==n.PE?null:n.PE.change)||""),t.xp6(1),t.hij(" ",t.lcZ(23,33,(null==n||null==n.PE?null:n.PE.openInterest)||0)," ")}}function N(l,o){if(1&l&&(t.ynx(0),t.TgZ(1,"span",23),t._uU(2),t.qZA(),t._uU(3," Underlying Index: "),t.TgZ(4,"span",23),t._uU(5),t.qZA(),t.TgZ(6,"span",23),t._uU(7),t.ALo(8,"number"),t.qZA(),t._uU(9," As on "),t.TgZ(10,"span",23),t._uU(11),t.qZA(),t._UZ(12,"span",24),t.TgZ(13,"div",17)(14,"table",25)(15,"thead",19)(16,"tr")(17,"th",26),t._uU(18,"OI"),t.qZA(),t.TgZ(19,"th",26),t._uU(20,"COI"),t.qZA(),t.TgZ(21,"th",26),t._uU(22,"Last Price"),t.qZA(),t.TgZ(23,"th",27),t._uU(24,"Strike Price"),t.qZA(),t.TgZ(25,"th",26),t._uU(26,"Last Price"),t.qZA(),t.TgZ(27,"th",26),t._uU(28,"COI"),t.qZA(),t.TgZ(29,"th",26),t._uU(30,"OI"),t.qZA()()(),t.TgZ(31,"tbody"),t.YNc(32,J,24,59,"tr",21),t.TgZ(33,"tr")(34,"td",28),t._uU(35),t.ALo(36,"number"),t.qZA(),t.TgZ(37,"td",28),t._uU(38),t.ALo(39,"number"),t.qZA(),t._UZ(40,"td"),t.TgZ(41,"td",29),t._uU(42),t.qZA(),t._UZ(43,"td"),t.TgZ(44,"td",28),t._uU(45),t.ALo(46,"number"),t.qZA(),t.TgZ(47,"td",28),t._uU(48),t.ALo(49,"number"),t.qZA()()()()(),t.BQk()),2&l){const n=t.oxw().$implicit,e=t.oxw(2).ngIf,a=t.oxw();t.xp6(2),t.hij(" ",n," "),t.xp6(3),t.hij(" ",a.data.type," "),t.xp6(2),t.hij(" ",t.lcZ(8,11,a.ob(e.data).get_option_data.data.records.underlyingValue)," "),t.xp6(4),t.hij(" ",a.ob(e.data).get_option_data.data.records.timestamp," "),t.xp6(21),t.Q6J("ngForOf",a.ob(e.data).get_option_data.expiryData[n]),t.xp6(3),t.hij(" ",t.lcZ(36,13,a.ob(e.data).get_option_data.PCR[n].TTL_CE)," "),t.xp6(3),t.hij(" ",t.lcZ(39,15,a.ob(e.data).get_option_data.PCR[n].TTL_C_CE)," "),t.xp6(4),t.AsE(" ",a.ob(e.data).get_option_data.PCR[n].PCR," / ",a.ob(e.data).get_option_data.PCR[n].C_PCR," "),t.xp6(3),t.hij(" ",t.lcZ(46,17,a.ob(e.data).get_option_data.PCR[n].TTL_C_PE)," "),t.xp6(3),t.hij(" ",t.lcZ(49,19,a.ob(e.data).get_option_data.PCR[n].TTL_PE)," ")}}function $(l,o){if(1&l&&(t.TgZ(0,"div",22),t.YNc(1,N,50,21,"ng-container",11),t.qZA()),2&l){const n=o.$implicit,e=t.oxw(2).ngIf,a=t.oxw();t.xp6(1),t.Q6J("ngIf",16==a.ob(e).data.get_option_data.expiryData[n].length)}}function j(l,o){if(1&l&&(t.ynx(0),t.TgZ(1,"td",32),t._uU(2),t.qZA(),t.BQk()),2&l){const n=o.$implicit;t.xp6(2),t.Oqu(n)}}function k(l,o){1&l&&(t.ynx(0),t.TgZ(1,"td",29),t._uU(2,"PCR"),t.qZA(),t.TgZ(3,"td",29),t._uU(4,"C PCR"),t.qZA(),t.BQk())}const f=function(l,o,n){return{"text-bg-warning":l,"text-bg-danger":o,"text-bg-success":n}};function F(l,o){if(1&l&&(t.ynx(0),t.TgZ(1,"td",33)(2,"h2",34),t._uU(3),t.qZA()(),t.TgZ(4,"td",33)(5,"h2",34),t._uU(6),t.qZA()(),t.BQk()),2&l){const n=o.$implicit,e=t.oxw().$implicit,a=t.oxw(3);let i,d;t.xp6(2),t.Tol(t.kEZ(6,f,1==a.n(null==e.PCR[n]?null:e.PCR[n].PCR),a.n(null==e.PCR[n]?null:e.PCR[n].PCR)<1,a.n(null==e.PCR[n]?null:e.PCR[n].PCR)>1)),t.xp6(1),t.hij(" ",(null==(i=a.h_get_pcr(e,n))?null:i.PCR)||""," "),t.xp6(2),t.Tol(t.kEZ(10,f,1==a.n(null==e.PCR[n]?null:e.PCR[n].PCR),a.n(null==e.PCR[n]?null:e.PCR[n].PCR)<1,a.n(null==e.PCR[n]?null:e.PCR[n].PCR)>1)),t.xp6(1),t.hij(" ",(null==(d=a.h_get_pcr(e,n))?null:d.C_PCR)||""," ")}}function L(l,o){if(1&l&&(t.TgZ(0,"tr")(1,"td",29),t._uU(2),t.qZA(),t.TgZ(3,"td",29),t._uU(4),t.qZA(),t.YNc(5,F,7,14,"ng-container",21),t.qZA()),2&l){const n=o.$implicit,e=t.oxw(2).ngIf,a=t.oxw();t.xp6(2),t.Oqu(a.df(n.timestamp)),t.xp6(2),t.Oqu(a.n_text(n.underlyingValue)),t.xp6(1),t.Q6J("ngForOf",a.ob(e).data.get_option_data.expiryData_key)}}function M(l,o){if(1&l&&(t.TgZ(0,"div",0),t.YNc(1,$,2,1,"div",15),t.TgZ(2,"div",16)(3,"div",17)(4,"table",18)(5,"thead",19)(6,"tr")(7,"td",20),t._uU(8,"Time"),t.qZA(),t.TgZ(9,"td",20),t._uU(10,"U Value"),t.qZA(),t.YNc(11,j,3,1,"ng-container",21),t.qZA(),t.TgZ(12,"tr"),t.YNc(13,k,5,0,"ng-container",21),t.qZA()(),t.TgZ(14,"tbody"),t.YNc(15,L,6,3,"tr",21),t.qZA()()()()()),2&l){const n=t.oxw().ngIf,e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.ob(n).data.get_option_data.expiryData_key),t.xp6(10),t.Q6J("ngForOf",e.ob(n).data.get_option_data.expiryData_key),t.xp6(2),t.Q6J("ngForOf",e.ob(n).data.get_option_data.expiryData_key),t.xp6(2),t.Q6J("ngForOf",e.ob(n.data).PCR.reverse())}}function Q(l,o){if(1&l&&(t.TgZ(0,"div"),t.YNc(1,M,16,4,"div",14),t.qZA()),2&l){const n=o.ngIf;t.xp6(1),t.Q6J("ngIf",null!=n.data)}}const w=function(l){return{data:l}},D=[{path:"",component:(()=>{class l{constructor(n){this.hs=n,this.data={sub$$:new v.x,data$:(0,C.of)([]),date:"2023-02-24",type:"NIFTY",n:0},this.get_prc=e=>(0,b.D)(fetch(`${this.hs.getUrl()}/data/${e.date}_PCR_${e.type}`).then(a=>a.text())).pipe((0,Z.U)(a=>a.split("\n").filter(Boolean).map(i=>JSON.parse(i)))),this._getNew=()=>(0,Z.U)(e=>{if(null==e?.records?.data)return;e.records.data=e.records.data.map(r=>(null!=r.PE&&(r.flag=!(r.PE.underlyingValue>r.PE.strikePrice)),r));let a=this.getAllopData({data:e}),i=Object.keys(a),d=i.reduce((r,s)=>{let x=_.chain(a[s]).map("CE.openInterest").sum().value(),T=_.chain(a[s]).map("PE.openInterest").sum().value(),E=_.chain(a[s]).map("CE.changeinOpenInterest").sum().value(),P=_.chain(a[s]).map("PE.changeinOpenInterest").sum().value();return r[s]={PCR:Number(T/x).toFixed(2),C_PCR:Number(P/E).toFixed(2),TTL_CE:x,TTL_PE:T,TTL_C_CE:E,TTL_C_PE:P},r},{});return{data:e,expiryData:a,expiryData_key:i,PCR:d}}),this.ob=e=>e,this.n=e=>Number(Number(e).toFixed(2)),this.n_text=e=>Number(e).toFixed(2)}get_option_data(n){return this.hs.ajaxp(`${this.hs.getUrl()}/getData/${n.date}_${n.type}?n=${n.n}`).pipe(this._getNew())}ngOnInit(){this.data.data$=this.data.sub$$.pipe((0,A.z)(n=>(0,O.D)({PCR:this.get_prc(n),get_option_data:this.get_option_data(n)}).pipe((0,U.b)(e=>{this.data.all=e}),(0,y.K)(e=>(delete this.data.all,(0,C.of)({PCR:[],get_option_data:{}})))))),setTimeout(()=>{this.data.sub$$.next(this.data)},10)}change(n){this.data.sub$$.next(n)}getAllopData(n){return _.chain(n.data.records.expiryDates).take(4).reduce((e,a)=>(e[a]=this.getexpiryData(a,n),e),{}).value()}getexpiryData(n,e){let a=_.chain(e.data.records.data).filter({expiryDate:n}).value();if(a.length<6)return _.chain(a).sortBy("strikePrice").value();let i=_.chain(a).filter({flag:!1}).sortBy("strikePrice").takeRight(8).value(),d=_.chain(a).filter({flag:!0}).sortBy("strikePrice").take(8).value();return _.chain([...i,...d]).sortBy("strikePrice").value()}h_get_pcr(n,e){return n.PCR[e]||{}}prev(n,e){"p"==e&&n.n--,"n"==e&&n.n++,this.data.sub$$.next(n)}time_change(n){this.data.sub$$.next(n)}change_date(n){n.n=0,this.data.sub$$.next(n)}df(n){return this.hs.dateformat(n)}}return l.\u0275fac=function(n){return new(n||l)(t.Y36(R.e))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-option"]],decls:19,vars:8,consts:[[1,"row"],[1,"col-3"],["type","date","id","birthday","name","birthday",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","change"],["aria-label","Default select example",1,"form-select","form-select-sm",3,"ngModel","ngModelChange","change"],["value","NIFTY"],["value","BANKNIFTY"],["class","col-3",4,"ngIf"],["type","button","id","option_refresh",1,"btn","btn-sm","btn-danger","me-2",3,"click"],[1,"fa-solid","fa-backward"],["type","button",1,"btn","btn-sm","btn-danger","me-2",3,"click"],[1,"fa-solid","fa-forward"],[4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["class","row",4,"ngIf"],["class","col-md-6 col-lg-6 col-12",4,"ngFor","ngForOf"],[1,"col-12"],[1,"table-responsive"],[1,"table","table-sm","table-striped","table-hover","mt-2"],[1,"header-fixed","bg"],["rowspan","2",1,"text-center"],[4,"ngFor","ngForOf"],[1,"col-md-6","col-lg-6","col-12"],[1,"fw-semibold"],[1,"badge","text-bg-primary"],["id","example",1,"table","table-sm","table-striped","table-hover","mt-2"],[1,"text-end","text-nowrap"],[1,"text-center","text-nowrap"],[1,"text-end"],[1,"text-center"],[1,"text-end",3,"title"],[2,"font-size","0.5rem"],["colspan","2",1,"text-center"],[1,"text-white","text-center"],[1,"badge","text-bg-primary","bg-opacity-50"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"input",2),t.NdJ("ngModelChange",function(i){return e.data.date=i})("change",function(){return e.change_date(e.data)}),t.qZA()(),t.TgZ(3,"div",1)(4,"select",3),t.NdJ("ngModelChange",function(i){return e.data.type=i})("change",function(){return e.change_date(e.data)}),t.TgZ(5,"option"),t._uU(6,"-SELECT-"),t.qZA(),t.TgZ(7,"option",4),t._uU(8,"NIFTY"),t.qZA(),t.TgZ(9,"option",5),t._uU(10,"BANKNIFTY"),t.qZA()()(),t.YNc(11,I,5,2,"div",6),t.TgZ(12,"div",1)(13,"button",7),t.NdJ("click",function(){return e.prev(e.data,"p")}),t._UZ(14,"i",8),t.qZA(),t.TgZ(15,"button",9),t.NdJ("click",function(){return e.prev(e.data,"n")}),t._UZ(16,"i",10),t.qZA()()(),t.YNc(17,Q,2,1,"div",11),t.ALo(18,"async")),2&n&&(t.xp6(2),t.Q6J("ngModel",e.data.date),t.xp6(2),t.Q6J("ngModel",e.data.type),t.xp6(7),t.Q6J("ngIf",null!=e.data.all),t.xp6(6),t.Q6J("ngIf",t.VKq(6,w,t.lcZ(18,4,e.data.data$))))},dependencies:[g.sg,g.O5,p.YN,p.Kr,p.Fj,p.EJ,p.JJ,p.On,g.Ov,g.JJ]}),l})()}];let Y=(()=>{class l{}return l.\u0275fac=function(n){return new(n||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({imports:[m.Bz.forChild(D),m.Bz]}),l})(),B=(()=>{class l{}return l.\u0275fac=function(n){return new(n||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({imports:[g.ez,Y,p.u5]}),l})()}}]);